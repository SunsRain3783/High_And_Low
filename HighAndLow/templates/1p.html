{% load static %}
<!doctype HTML>
<html>
    <head>
        <link rel="stylesheet" href="{% static '1p.css' %}">
    </head>
    <body onload="firstScript();"><!--ここから中身-->
    <!--ヘッダー-->
    <div class="header">
        <a href="/" class="btn-flat-vertical-border">トップページ</a>
        <a href="#" class="btn-flat-vertical-border2" style="left:85%;">遊び方</a>
    </div>
    
    <!--トランプの画像-->
    <div style="text-align: center">
        <img src="" width="270" class="bigcard" id="bigcard" />
    </div>
    <div style="text-align: center">
        <img src="" width="260" class="smallcard" id="smallcard" />
    </div>
    
    <!--ハイアンドローボタン-->
    <div class="highbtn">
        <a href="#" class="btn" id="high" onclick="changeDisplay1();" >▲ HIGH ▲</a>
        <a href="#" class="btn2" id="low" onclick="changeDisplay1();" >▼ LOW ▼</a>
    </div>
    
    <!--続けるやめるボタン-->
    <div class="stopcont">
        <font size="20"><a href="#" class="bt-stop" id="stop" onclick="changeDisplay2();" >続ける</a></font>
        <font size="20"><a href="#" class="bt-cont" id="cont" onclick="changeDisplay2();" >やめる</a></font>
    </div>
    
    </body>
</html>

<script>
//カードの配列
    const images = ["{% static 'clover1.jpg' %}","{% static 'clover2.jpg' %}","{% static 'clover3.jpg' %}"
    ,"{% static 'clover4.jpg' %}","{% static 'clover5.jpg' %}","{% static 'clover6.jpg' %}","{% static 'clover7.jpg' %}"
    ,"{% static 'clover8.jpg' %}","{% static 'clover9.jpg' %}","{% static 'clover10.jpg' %}","{% static 'clover11.jpg' %}"
    ,"{% static 'clover11.jpg' %}","{% static 'clover12.jpg' %}","{% static 'clover13.jpg' %}","{% static 'spade1.jpg' %}"
    ,"{% static 'spade2.jpg' %}","{% static 'spade3.jpg' %}","{% static 'spade4.jpg' %}","{% static 'spade5.jpg' %}"
    ,"{% static 'spade6.jpg' %}","{% static 'spade7.jpg' %}","{% static 'spade8.jpg' %}","{% static 'spade9.jpg' %}"
    ,"{% static 'spade10.jpg' %}","{% static 'spade11.jpg' %}","{% static 'spade12.jpg' %}","{% static 'spade13.jpg' %}"
    ,"{% static 'heart1.jpg' %}","{% static 'heart2.jpg' %}","{% static 'heart3.jpg' %}","{% static 'heart4.jpg' %}"
    ,"{% static 'heart5.jpg' %}","{% static 'heart6.jpg' %}","{% static 'heart7.jpg' %}","{% static 'heart8.jpg' %}"
    ,"{% static 'heart9.jpg' %}","{% static 'heart10.jpg' %}","{% static 'heart11.jpg' %}","{% static 'heart12.jpg' %}"
    ,"{% static 'heart13.jpg' %}","{% static 'dia1.jpg' %}","{% static 'dia2.jpg' %}","{% static 'dia3.jpg' %}"
    ,"{% static 'dia4.jpg' %}","{% static 'dia5.jpg' %}","{% static 'dia6.jpg' %}","{% static 'dia7.jpg' %}"
    ,"{% static 'dia8.jpg' %}","{% static 'dia9.jpg' %}","{% static 'dia10.jpg' %}","{% static 'dia11.jpg' %}"
    ,"{% static 'dia12.jpg' %}","{% static 'dia13.jpg' %}"];
//関数の外に親カードと子カード用の変数を作成
var oyacard;
var kocard;
//親カードを設定する関数
    function oya(){
        oyacard = Math.floor( Math.random() * images.length);
    }
//子カードを設定する関数(親カードを設定したあとに呼び出す)
    function ko(){
        kocard = Math.floor( Math.random() * images.length);
        while(kocard === oyacard){//親カードとダブったら選びなおす
            kocard = Math.floor( Math.random() * images.length);
        }
    }
//裏面表示
    function changeBack(){
        document.getElementById("smallcard").src="{% static 'back.jpg' %}";
    }
//初期アクセス時の処理
    function firstScript(){
        oya();//親カードを設定
        document.getElementById("bigcard").src=images[oyacard];
        ko();//子カードを設定
        changeBack();//子カードを裏面に
        changeDisplay2();//続けるやめるボタンの非表示
    }
//カードをめくるアニメーション
    const buttonElem1 = document.getElementById('high');
    const buttonElem2 = document.getElementById('low');
    let isBack = true;
    
    if(buttonElem1 !== null){
        buttonElem1.addEventListener('click', () => {
            const element = document.getElementById('smallcard');
            if(element !== null){
                let imagePath = isBack ? images[kocard] : "{% static 'back.jpg' %}";
                rotationAnimationLoop(element, imagePath, 0);
                isBack = !isBack;
            }
        });
    }
    if(buttonElem2 !== null){
        buttonElem2.addEventListener('click', () => {
            const element = document.getElementById('smallcard');
            if(element !== null){
                let imagePath = isBack ? images[kocard] : "{% static 'back.jpg' %}";
                rotationAnimationLoop(element, imagePath, 0);
                isBack = !isBack;
            }
        });
    }
    const rotationAnimationLoop = (element, imagePath, deg) =>{
        element.style.webkitTransform = 'rotateY(360deg)';
        if( deg <= 180 ){
            rotationAnimation(element, imagePath, deg);
            setTimeout( 
                () => {
                    rotationAnimationLoop(element, imagePath, deg+= 5 ) 
                }, 
            1 );
        }
    }
    const rotationAnimation = (element, imagePath, deg) =>{
        if ( 180 === deg ){
            element.src =  imagePath;//画像の切り替え
        }
        else {
            element.style.webkitTransform = 'rotateY(' + deg + 'deg)';//回転アニメーション
        }
    }
//ボタンの表示非表示
    function changeDisplay1(){//ハイアンドローボタン
      var high = document.getElementById("high");
      var low = document.getElementById("low");
      if(high.style.visibility == "hidden"){
        high.style.visibility = "visible";
        low.style.visibility = "visible";
      }else{
        high.style.visibility = "hidden";
        low.style.visibility = "hidden";
      }
      if(judg() === "success"){
          setTimeout("changeDisplay2();",650);
      }
      else{
          setTimeout("changeDisplay3();",650);
      }
    }
    function changeDisplay2(){//続けるやめるボタン
      var stop = document.getElementById("stop");
      var cont = document.getElementById("cont");
      if(stop.style.display == "none"){
        stop.style.display = "block";
        cont.style.display = "block";
      }else{
        stop.style.display = "none";
        cont.style.display = "none";
      }
    }
    function changeDisplay3(){//ベット画面
        
    }
//成功失敗の判定
    function judg(){
        
    }
</script>